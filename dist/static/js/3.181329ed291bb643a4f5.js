webpackJsonp([3],{BO1k:function(t,e,i){t.exports={default:i("fxRn"),__esModule:!0}},fxRn:function(t,e,i){i("+tPU"),i("zQR9"),t.exports=i("g8Ux")},g8Ux:function(t,e,i){var n=i("77Pl"),r=i("3fs2");t.exports=i("FeBl").getIterator=function(t){var e=r(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return n(e.call(t))}},yNA7:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("bOdI"),r=i.n(n),a=i("fZjL"),s=i.n(a);function o(t){var e=t.responseText||t.response;if(!e)return e;try{return JSON.parse(e)}catch(t){return e}}function l(t){if("undefined"!=typeof XMLHttpRequest){var e=new XMLHttpRequest,i=t.action;e.upload&&(e.upload.onprogress=function(e){e.total>0&&(e.percent=e.loaded/e.total*100),t.onProgress(e)});var n=new FormData;t.data&&s()(t.data).map(function(e){n.append(e,t.data[e])}),n.append(t.filename,t.file),e.onerror=function(e){t.onError(e)},e.onload=function(){if(e.status<200||e.status>=300)return t.onError(function(t,e,i){var n="fail to post "+t+" "+i.status+"'",r=new Error(n);return r.status=i.status,r.method="post",r.url=t,r}(i,0,e),o(e));t.onSuccess(o(e))},e.open("post",i,!0),t.withCredentials&&"withCredentials"in e&&(e.withCredentials=!0);var r=t.headers||{};for(var a in r)r.hasOwnProperty(a)&&null!==r[a]&&e.setRequestHeader(a,r[a]);e.send(n)}}i("BO1k");var u=i("7+uW").a.prototype.$isServer;!u&&(window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver);var c={name:"Upload",mixins:[{methods:{dispatch:function(t,e,i){for(var n=this.$parent||this.$root,r=n.$options.name;n&&(!r||r!==t);)(n=n.$parent)&&(r=n.$options.name);n&&n.$emit.apply(n,[e].concat(i))},broadcast:function(t,e,i){(function t(e,i,n){this.$children.forEach(function(r){r.$options.name===e?r.$emit.apply(r,[i].concat(n)):t.apply(r,[e,i].concat([n]))})}).call(this,t,e,i)}}}],props:{action:{type:String,required:!0},headers:{type:Object,default:function(){return{}}},multiple:{type:Boolean,default:!1},data:{type:Object},name:{type:String,default:"file"},withCredentials:{type:Boolean,default:!1},showUploadList:{type:Boolean,default:!0},type:{type:String,validator:function(t){return function(t,e){for(var i=0;i<e.length;i++)if(t===e[i])return!0;return!1}(t,["select","drag"])},default:"select"},format:{type:Array,default:function(){return[]}},accept:{type:String},maxSize:{type:Number},beforeUpload:Function,onProgress:{type:Function,default:function(){return{}}},onSuccess:{type:Function,default:function(){return{}}},onError:{type:Function,default:function(){return{}}},onRemove:{type:Function,default:function(){return{}}},onPreview:{type:Function,default:function(){return{}}},onExceededSize:{type:Function,default:function(){return{}}},onFormatError:{type:Function,default:function(){return{}}},defaultFileList:{type:Array,default:function(){return[]}}},data:function(){return{prefixCls:"ivu-upload",dragOver:!1,fileList:[],tempIndex:1}},computed:{classes:function(){var t;return["ivu-upload",(t={},r()(t,"ivu-upload-select","select"===this.type),r()(t,"ivu-upload-drag","drag"===this.type),r()(t,"ivu-upload-dragOver","drag"===this.type&&this.dragOver),t)]}},methods:{handleClick:function(){this.$refs.input.click()},handleChange:function(t){var e=t.target.files;e&&(this.uploadFiles(e),this.$refs.input.value=null)},onDrop:function(t){this.dragOver=!1,this.uploadFiles(t.dataTransfer.files)},uploadFiles:function(t){var e=this,i=Array.prototype.slice.call(t);this.multiple||(i=i.slice(0,1)),0!==i.length&&i.forEach(function(t){e.upload(t)})},upload:function(t){var e=this;if(!this.beforeUpload)return this.post(t);var i=this.beforeUpload(t);i&&i.then?i.then(function(i){"[object File]"===Object.prototype.toString.call(i)?e.post(i):e.post(t)},function(){}):!1!==i&&this.post(t)},post:function(t){var e=this;if(this.format.length){var i=t.name.split(".").pop().toLocaleLowerCase();if(!this.format.some(function(t){return t.toLocaleLowerCase()===i}))return this.onFormatError(t,this.fileList),!1}if(this.maxSize&&t.size>1024*this.maxSize)return this.onExceededSize(t,this.fileList),!1;this.handleStart(t),(new FormData).append(this.name,t),l({headers:this.headers,withCredentials:this.withCredentials,file:t,data:this.data,filename:this.name,action:this.action,onProgress:function(i){e.handleProgress(i,t)},onSuccess:function(i){e.handleSuccess(i,t)},onError:function(i,n){e.handleError(i,n,t)}})},handleStart:function(t){t.uid=Date.now()+this.tempIndex++;var e={status:"uploading",name:t.name,size:t.size,percentage:0,uid:t.uid,showProgress:!0};this.fileList.push(e)},getFile:function(t){var e=void 0;return this.fileList.every(function(i){return!(e=t.uid===i.uid?i:null)}),e},handleProgress:function(t,e){var i=this.getFile(e);this.onProgress(t,i,this.fileList),i.percentage=t.percent||0},handleSuccess:function(t,e){var i=this.getFile(e);i&&(i.status="finished",i.response=t,this.dispatch("FormItem","on-form-change",i),this.onSuccess(t,i,this.fileList),setTimeout(function(){i.showProgress=!1},1e3))},handleError:function(t,e,i){var n=this.getFile(i),r=this.fileList;n.status="fail",r.splice(r.indexOf(n),1),this.onError(t,e,i)},handleRemove:function(t){var e=this.fileList;e.splice(e.indexOf(t),1),this.onRemove(t,e)},handlePreview:function(t){"finished"===t.status&&this.onPreview(t)},clearFiles:function(){this.fileList=[]}},watch:{defaultFileList:{immediate:!0,handler:function(t){var e=this;this.fileList=t.map(function(t){return t.status="finished",t.percentage=100,t.uid=Date.now()+e.tempIndex++,t})}}}},f={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:[t.prefixCls]},[i("div",{class:t.classes,on:{click:t.handleClick,drop:function(e){return e.preventDefault(),t.onDrop(e)},dragover:function(e){e.preventDefault(),t.dragOver=!0},dragleave:function(e){e.preventDefault(),t.dragOver=!1}}},[i("input",{ref:"input",class:[t.prefixCls+"-input"],attrs:{type:"file",multiple:t.multiple,accept:t.accept},on:{change:t.handleChange}}),t._v(" "),t._t("default")],2),t._v(" "),t._t("tip")],2)},staticRenderFns:[]},d={name:"UploadController",data:function(){return{token:"",action:"http://apitest.amborzex.com/amborzex/workorder/uploadFile",defaultList:[{fileType:1,name:"双瞳如小窗 佳景观历历",url:"http://static.ydcss.com/uploads/lightbox/meizu_3.jpg"}],formInline:{fileList:[]}}},methods:{handleMaxSize:function(t){console.log("文件不能超过5M")},handleSuccess:function(t,e,i){if(200==t.code)console.log(e),e.url=t.result.url,e.fileType=t.result.fileType;else{var n=this.formInline.fileList;this.formInline.fileList.splice(n.indexOf(e),1)}},handleRemove:function(t){var e=this.$refs.upload.fileList;this.$refs.upload.fileList.splice(e.indexOf(t),1)},handleFormatError:function(t){console.log("上传失败")},handleBeforeUpload:function(t,e){var i=this.formInline.fileList.length<5;return i||this.$xfdDialog.toast("最多上传五张"),i}},components:{Upload:i("VU/8")(c,f,!1,null,null,null).exports},mounted:function(){this.formInline.fileList=this.$refs.upload.fileList}},p={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"xfd-viewpager"},[i("header",{staticClass:"xfd-header xfd-border-b"},[i("div",{directives:[{name:"router",rawName:"v-router",value:{router:this.$router},expression:"{router:this.$router}"}],staticClass:"xfd-header-left"},[i("span",[t._v("返回")])]),t._v(" "),i("h1",[t._v("图片上传(Upload)))")]),t._v(" "),i("div",{staticClass:"xfd-header-right text-center"})]),t._v(" "),i("section",{staticClass:"xfd-container"},[i("div",{staticClass:"xfd-form xfd-cells-box"},[i("div",{staticClass:"xfd-line xfd-cells"},[i("label",{staticClass:"xfd-form-label"},[t._v("上传附件")]),t._v(" "),i("div",{staticClass:"xfd-col-1 xfd-form-input"},[i("div",{staticClass:"xfd-upload-box xfd-clearfix"},[i("div",{staticClass:"xfd-upload-list"},t._l(t.formInline.fileList,function(e){return i("div",{staticClass:"xfd-upload-item"},["finished"===e.status?[i("div",{staticClass:"item-img images"},[i("img",{attrs:{src:e.url}})])]:[t._m(0,!0)],t._v(" "),i("i",{staticClass:"upload-close icon iconfont icon-guanbi2fill",on:{click:function(i){i.stopPropagation(),t.handleRemove(e)}}})],2)})),t._v(" "),i("div",{staticClass:"text-primary"},[i("Upload",{ref:"upload",attrs:{multiple:!0,"max-size":5120,"show-upload-list":!1,"default-file-list":t.defaultList,action:t.action,headers:{Authorization:t.token},"on-success":t.handleSuccess,"on-format-error":t.handleFormatError,"before-upload":t.handleBeforeUpload,"on-exceeded-size":t.handleMaxSize}},[i("div",{staticClass:"upload-btn-box"},[i("i",{staticClass:"icon iconfont icon-xiangji1fill"})])])],1)])])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"item-img"},[e("span",{staticClass:"xfd-loadmore"},[e("i",{staticClass:"xfd-loading"})]),this._v(" "),e("p",{staticStyle:{"font-size":"12px"}},[this._v("正在上传")])])}]},h=i("VU/8")(d,p,!1,null,null,null);e.default=h.exports}});
//# sourceMappingURL=3.181329ed291bb643a4f5.js.map